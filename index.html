<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Games Planet ‚Äî Order (Patched)</title>
<meta name="description" content="Games Planet order page ‚Äî PS2 Essentials, catalog, filters. Robust image loader included."/>
<style>
:root{
  --bg:#0b1020; --panel:#0f1530; --card:#121a33; --muted:#9fb0d3; --text:#eaf1ff;
  --accent:#7c4dff; --accent2:#3ddc84; --chip:#1b2447; --shadow:0 10px 30px rgba(0,0,0,.35);
}
@media(prefers-color-scheme:light){:root{--bg:#f7f8ff;--panel:#eef2ff;--card:#ffffff;--text:#0b1020;--muted:#51607e;--chip:#e7ebff;--shadow:0 8px 20px rgba(11,16,32,.08)}}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(60vw 60vw at 10% -10%, rgba(124,77,255,.20), transparent 40%),
    radial-gradient(50vw 50vw at 110% 10%, rgba(61,220,132,.20), transparent 40%),
    var(--bg);
  color:var(--text);
  scrollbar-gutter: stable both-edges;
  overflow-x:hidden;
  word-wrap:break-word;
  overflow-wrap:anywhere;
}

/* layout */
.topbar{ position:sticky; top:0; z-index:55; backdrop-filter:saturate(120%) blur(8px);
  background:linear-gradient(180deg,rgba(0,0,0,.35),transparent); border-bottom:1px solid rgba(255,255,255,.08);
}
.brand{ max-width:1300px; margin:0 auto; padding:14px 18px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
.logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;font-weight:900;background:linear-gradient(135deg,var(--accent),#5ecbff);color:#fff;box-shadow:var(--shadow)}
.brand h1{font-size:clamp(18px,2.6vw,26px); margin:0}
.brand .sub{font-size:12px;color:var(--muted)}

.app{max-width:1300px;margin:0 auto;padding:18px 18px 120px}
.togglebar{position:fixed;top:76px;left:12px;z-index:60;display:flex;gap:8px}
.tbtn{border:0;background:var(--accent);color:#fff;padding:10px 12px;border-radius:12px;box-shadow:var(--shadow);font-weight:800;cursor:pointer;white-space:normal;line-height:1.1}
.tbtn.secondary{background:var(--chip);color:var(--text)}

.sidebar{ position:fixed; top:0; left:0; height:100vh; width:320px; max-width:86vw; background:rgba(17,24,48,.55); backdrop-filter: blur(12px) saturate(140%); -webkit-backdrop-filter: blur(12px) saturate(140%); border-right:1px solid rgba(255,255,255,.12); box-shadow:var(--shadow); z-index:70; overflow:auto; transform:translateX(-100%); transition:transform .25s ease; padding:14px 14px 18px; }
.sidebar.open{transform:translateX(0)}
.backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.4); z-index:65; display:none; }
.backdrop.show{display:block}

.card{background:var(--card);border-radius:18px;padding:16px;box-shadow:var(--shadow);position:relative;overflow:hidden;margin-bottom:18px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:var(--chip);color:var(--muted);border-radius:999px;font-size:12px;font-weight:700;margin-right:6px}
.title{margin:8px 0 6px;font-size:18px}
.muted{color:var(--muted);font-size:14px}
.grid{display:flex;flex-direction:column;gap:12px}

.row{display:grid;grid-template-columns:minmax(140px,1fr) auto;gap:8px;align-items:center}
.name{font-weight:800;min-width:0}
.variantline{ display:flex;gap:8px;flex-wrap:wrap; white-space:normal; padding-bottom:4px;max-width:100%; }
.btn{ border:0;padding:9px 12px;border-radius:12px;font-weight:800;cursor:pointer;flex:0 1 auto; white-space:normal; line-height:1.12;text-align:center;min-width:96px;max-width:100%; }
.btn.buy{background:var(--accent2);color:#08210f}
.btn.link{background:var(--chip);color:var(--text)}

.fh{font-size:13px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin:8px 0 6px}
.fgroup{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
.chk{display:flex;align-items:center;gap:8px}
.chk input{accent-color:var(--accent)}
.clearbox{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.small{font-size:12px;color:var(--muted)}

.imgrow{display:flex;gap:12px;flex-wrap:wrap;margin:8px 0}
.imgrow img{border-radius:12px;box-shadow:var(--shadow);max-height:90px;height:auto;width:auto}

/* policies */
.policyblock{background:var(--card);border-radius:18px;padding:16px;box-shadow:var(--shadow);margin-bottom:18px}
.policyblock h3{margin:0 0 6px}
.applyline{font-size:12px;color:var(--muted);white-space:normal;overflow:visible}
ul.tight{margin:8px 0 0 18px}

/* footer */
.foot{opacity:.85;margin-top:24px;font-size:12px;color:var(--muted);text-align:center}
.dev-hint{font-size:12px;color:var(--muted);margin-top:6px}
</style>
</head>
<body>
<header class="topbar">
  <div class="brand">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="logo">GP</div>
      <div>
        <h1>Games Planet</h1>
        <div class="sub">Retro Consoles ‚Ä¢ GameSticks ‚Ä¢ PS2 Media</div>
      </div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <a class="tbtn secondary" href="https://wa.me/917983624797?text=I%20want%20to%20order%20from%20Games%20Planet" target="_blank" rel="noopener">WhatsApp</a>
    </div>
  </div>
</header>

<div class="togglebar">
  <button class="tbtn" id="toggleSidebar">‚ò∞ Filters</button>
</div>

<div class="sidebar" id="sidebar">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
    <div style="font-weight:900;letter-spacing:.06em;text-transform:uppercase;color:#dbe4ff;font-size:13px">Filters</div>
    <button class="tbtn secondary" id="closeSidebarTop" type="button">‚úñ Close</button>
  </div>
  <hr style="border:none;border-top:1px dashed rgba(255,255,255,.18);margin:8px 0 12px" />
  <div class="fgroup">
    <div class="fh">Price Band</div>
    <label class="chk"><input type="checkbox" name="price" value="0-1000"> ‚Çπ0‚Äì‚Çπ1000</label>
    <label class="chk"><input type="checkbox" name="price" value="1000-2000"> ‚Çπ1000‚Äì‚Çπ2000</label>
    <label class="chk"><input type="checkbox" name="price" value="2000-3000"> ‚Çπ2000‚Äì‚Çπ3000</label>
    <label class="chk"><input type="checkbox" name="price" value="3000-4000"> ‚Çπ3000‚Äì‚Çπ4000</label>
    <label class="chk"><input type="checkbox" name="price" value="4000-5000"> ‚Çπ4000‚Äì‚Çπ5000</label>
    <label class="chk"><input type="checkbox" name="price" value="5000-6000"> ‚Çπ5000‚Äì‚Çπ6000</label>
    <label class="chk"><input type="checkbox" name="price" value="6000-7000"> ‚Çπ6000‚Äì‚Çπ7000</label>
  </div>
  <div class="fgroup">
    <div class="fh">Category</div>
    <label class="chk"><input type="checkbox" name="category" value="Gamebox"> Gamebox</label>
    <label class="chk"><input type="checkbox" name="category" value="Gamestick"> Gamestick</label>
    <label class="chk"><input type="checkbox" name="category" value="Renewed"> Renewed consoles</label>
    <!-- Accessories checkbox left for compatibility but accessories themselves were removed -->
    <label class="chk"><input type="checkbox" name="category" value="Accessories"> Accessories</label>
  </div>
  <div class="fgroup">
    <div class="fh">Type</div>
    <label class="chk"><input type="checkbox" name="type" value="Game+Android"> Game + Android</label>
    <label class="chk"><input type="checkbox" name="type" value="GameOnly"> Game only</label>
    <label class="chk"><input type="checkbox" name="type" value="Handheld"> Handheld</label>
    <label class="chk"><input type="checkbox" name="type" value="Accessories"> Accessories</label>
  </div>
  <div class="clearbox" style="margin-bottom:6px">
    <button class="tbtn" id="applyFilters" type="button">Apply Filters</button>
    <button class="tbtn secondary" id="resetFilters" type="button">Reset All</button>
  </div>
  <div class="small">Tip: Multiple boxes select kar sakte ho. Koi selection na ho to sab products dikhte hain.</div>
</div>

<div class="backdrop" id="backdrop"></div>

<div class="app">
  <main class="content">

    <!-- PS2 Essentials combined card -->
    <section class="card" id="ps2-essentials-card">
      <span class="badge">PS2 Essentials</span>
      <h2 class="title">FMCB ‚Ä¢ Games USB ‚Ä¢ FMCB + USB Combo (PS2)</h2>
      <div class="imgrow" id="ps2-imgrow">
        <!-- images injected by JS -->
      </div>
      <div class="muted">Essential PS2 media: FMCB / FunTuna memory card, preloaded USB drives, combo packs and key accessories.</div>
      <div class="variantline" style="margin-top:10px">
        <a class="btn buy" id="ps2-buy" href="https://gamesplanet13.github.io/ps2fmcb/" target="_blank" rel="noopener">Buy Now ‚Ä¢ FMCB / Games USB / Combo</a>
      </div>
      <div class="dev-hint">(If images are missing: open browser DevTools ‚Üí Console to see missing filenames.)</div>
    </section>

    <!-- Catalog -->
    <section class="card">
      <span class="badge">Catalog</span>
      <h2 class="title">Products</h2>
      <div class="grid" id="productGrid"></div>
    </section>

    <!-- Policies -->
    <section class="policyblock" id="policy-fmcb">
      <h3>Policy ‚Äî FMCB / FunTuna (PS2 Memory Card)</h3>
      <div class="applyline" id="apply-fmcb"></div>
      <ul class="tight">
        <li>üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-media">
      <h3>Policy ‚Äî PS2 Media (USB / SSD / HDD)</h3>
      <div class="applyline" id="apply-media"></div>
      <ul class="tight">
        <li>üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
        <li>üõ°Ô∏è Warranty (media only): 64GB / 128GB / 128GB SSD ‚Äì 1 Year; 256GB / 500GB SSD ‚Äì 1 Year; 500GB HDD ‚Äì 6 Months; USB enclosure ‚Äì No Warranty</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-consoles">
      <h3>Policy ‚Äî Handheld Consoles, Gamestick & Gamebox</h3>
      <div class="applyline" id="apply-consoles"></div>
      <ul class="tight">
        <li>üîÅ 3 Days Replacement</li>
        <li>‚Ü©Ô∏è 3 Days Returnable ‚Äî 70% refund (within replacement window)</li>
        <li>üõ†Ô∏è 1 Month Software Warranty / Reinstallation (1-side courier charge by customer)</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-accessories">
      <h3>Policy ‚Äî Accessories</h3>
      <div class="applyline" id="apply-accessories"></div>
      <ul class="tight">
        <li>üö´ No Warranty ‚Ä¢ üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
      </ul>
    </section>

    <div class="foot">¬© Games Planet ‚Äî WhatsApp: +91 79836 24797 ‚Ä¢ Prices in INR.</div>

  </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const fmt = n => "‚Çπ"+Number(n).toLocaleString("en-IN");
  function goPrefill(product,variant,base,pack){
    const q=new URLSearchParams({product,variant,base,pack});
    location.href='order-prefill.html?'+q.toString();
  }

  /* Sidebar open/close */
  const sidebar = document.getElementById('sidebar');
  const backdrop = document.getElementById('backdrop');
  const toggleBtn = document.getElementById('toggleSidebar');
  const closeTop = document.getElementById('closeSidebarTop');
  function openSB(){ sidebar?.classList.add('open'); backdrop?.classList.add('show'); }
  function closeSB(){ sidebar?.classList.remove('open'); backdrop?.classList.remove('show'); }
  toggleBtn?.addEventListener('click', ()=> sidebar?.classList.contains('open') ? closeSB() : openSB());
  closeTop?.addEventListener('click', closeSB);
  backdrop?.addEventListener('click', closeSB);

  /* Catalog data (accessories removed per request) */
  const catalog = [
    // Gamebox
    { name:"GameBox G11 Pro (Regular)", category:"Gamebox", type:"Game+Android",
      variants:[{name:"64GB", price:4599},{name:"128GB", price:6599},{name:"256GB", price:7599}] },
    { name:"GameBox Plus G10 (Vayava)", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:3599}] },
    { name:"GD35 (Vayava)", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:5299},{name:"128GB", price:6999},{name:"256GB", price:7999}] },
    { name:"GD35 GTA San Andreas HD Edition", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:5999},{name:"128GB", price:7699},{name:"256GB", price:8699}] },

    // Gamestick / Handheld (existing)
    { name:"Gamestick Lite (Pandora Mini M8)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:1599}] },
    { name:"Gamestick Pro (Pandora Pro M15)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:1899}] },
    { name:"Gamestick GD10 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:2399},{name:"128GB", price:4399}] },
    { name:"GPZ M33", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:2699},{name:"128GB", price:4999},{name:"256GB", price:5999}] },
    { name:"GPZ M22", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3499},{name:"128GB", price:5999},{name:"256GB", price:6999}] },
    { name:"GPZ M55", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3499},{name:"128GB", price:5999},{name:"256GB", price:6999}] },
    { name:"Gamestick GS5 Mini", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3699},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v1 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3599},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v2 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3599},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v3 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3699},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick M88", category:"Gamestick", type:"GameOnly",
      variants:[{name:"128GB", price:7799}] },

    // NEW handhelds you provided
    { name:"R35s (Budget) ‚Äî Handheld", category:"Gamestick", type:"Handheld",
      variants:[{name:"64GB", price:2799}] },
    { name:"R35s ‚Äî Handheld", category:"Gamestick", type:"Handheld",
      variants:[{name:"64GB", price:3299}] },
    { name:"R36 Ultra ‚Äî Handheld", category:"Gamestick", type:"Handheld",
      variants:[{name:"64GB", price:3999}] }
  ];

  /* imageMap supports string or array (first valid candidate used) */
  const imageMap = {
    "PS2-essentials": ["Fmcb.png","Usb.jpg","Usbhdd.jpeg","Ps2hdmi.jpeg","Ps2wire.jpeg","Ps2wireless.jpeg"],
    "GPZ M55": "M55.jpeg",
    "GPZ M22": ["M22.jpeg","M22.jpg"],
    "GPZ M33": "M33.jpeg",
    "Gamestick M88": "M88.jpeg",
    "GameBox G11 Pro (Regular)": "G11pro.jpeg",
    "GameBox Plus G10 (Vayava)": ["G10.jpeg","G10b.jpeg"],
    "GD35 (Vayava)": "Gd35.jpeg",
    "Gamestick Lite (Pandora Mini M8)": "M8.jpeg",
    "Gamestick Pro (Pandora Pro M15)": "M15.jpeg",
    "Gamestick GD10 (Vayava)": "Gd10.jpeg",
    "Gamestick GD30 v1 (Vayava)": "Gd30.jpeg",
    "Gamestick GD30 v2 (Vayava)": "Gd30.jpeg",
    "Gamestick GD30 v3 (Vayava)": "Gd30v3.jpeg",
    "Gamestick GS5 Mini": ["Gs5mini.jpeg","GS5MINI2.jpeg"],
    // NEW handheld images (exact filenames provided earlier)
    "R35s (Budget) ‚Äî Handheld": "R35sb.jpeg",
    "R35s ‚Äî Handheld": "R35s.jpeg",
    "R36 Ultra ‚Äî Handheld": ["R36U.jpeg","R36s.png","R36sb.jpeg"],
    // fallbacks / short-keys
    "GD35":"Gd35.jpeg",
    "G11 Pro":"G11pro.jpeg",
    "G10":["G10.jpeg","G10b.jpeg"],
    "GD10":"Gd10.jpeg",
    "GS5 Mini":["Gs5mini.jpeg","GS5MINI2.jpeg"],
    "M22":["M22.jpeg","M22.jpg"]
  };

  /* video map (as before) */
  const videoMap = {
    "GD35 (Vayava)": [
      {label:"‚ñ∂Ô∏è YouTube ‚Ä¢ Unboxing", url:"https://youtu.be/v1k6gJtREfk?si=3RHYWRwmI34bxxlv"},
      {label:"‚ñ∂Ô∏è YouTube ‚Ä¢ Gameplay Guide", url:"https://youtu.be/-6jDWfplmkY?si=o90IJTPaEZaCyZhd"}
    ],
    "GameBox G11 Pro (Regular)": [
      {label:"‚ñ∂Ô∏è YouTube ‚Ä¢ Unboxing", url:"https://youtu.be/kJNJ_Kq3NvA?si=C-_ekj4Qna4LzO-s"},
      {label:"‚ñ∂Ô∏è YouTube ‚Ä¢ Connection Guide", url:"https://youtu.be/HoRVcbKb77Q?si=X3oSNCYncTLqos-s"},
      {label:"‚ñ∂Ô∏è YouTube ‚Ä¢ Special Edition Demo", url:"https://youtu.be/ILHGhkGNJ2s?si=h-4AWK2YRsPRcvIc"}
    ]
  };
  window.videoMap = videoMap;

  /* helper: build candidate paths for a filename/array */
  function candidatesFor(nameOrArray){
    const out = [];
    if(!nameOrArray) return out;
    const names = Array.isArray(nameOrArray) ? nameOrArray.slice() : [nameOrArray];
    names.forEach(name=>{
      if(!name) return;
      out.push(name);
      out.push(name.toLowerCase());
      if(!name.startsWith('./')) out.push('./'+name);
      if(!name.startsWith('assets/')) out.push('assets/'+name);
      // try common extensions if name has ext
      const m = name.match(/(.+)\.(jpg|jpeg|png|webp)$/i);
      if(m){
        const base = m[1];
        ['png','jpg','jpeg','webp'].forEach(ext=>{
          const s = base + '.' + ext;
          if(!out.includes(s)) out.push(s);
        });
      }
    });
    // unique preserve order
    return [...new Set(out)];
  }

  /* tries to load candidates sequentially; hides image if none load */
  function tryLoadImageElement(imgEl, candidates, idx=0){
    if(!candidates || candidates.length===0){ imgEl.style.display='none'; console.warn('No candidates for image element', imgEl); return; }
    if(idx >= candidates.length){ imgEl.style.display='none'; console.warn('Image load failed for all candidates:', candidates); 
      // show small textual hint so user can see missing image in UI
      const hint = document.createElement('div'); hint.className='small'; hint.textContent = 'Image missing: ' + (Array.isArray(candidates)?candidates[0]:candidates);
      imgEl.parentElement && imgEl.parentElement.appendChild(hint);
      return; }
    const src = candidates[idx];
    function onErr(){
      imgEl.removeEventListener('error', onErr);
      imgEl.removeEventListener('load', onLoad);
      // try next
      tryLoadImageElement(imgEl, candidates, idx+1);
    }
    function onLoad(){
      imgEl.removeEventListener('error', onErr);
      imgEl.removeEventListener('load', onLoad);
      imgEl.dataset.resolved = src;
      imgEl.style.display = '';
    }
    imgEl.addEventListener('error', onErr);
    imgEl.addEventListener('load', onLoad);
    // set src (will trigger load/error)
    imgEl.src = src;
    // also set a fallback timeout in case onerror doesn't fire quickly (some local files behave oddly)
    setTimeout(()=> {
      if(!imgEl.dataset.resolved && imgEl.complete && imgEl.naturalWidth===0){
        // treat as error
        tryLoadImageElement(imgEl, candidates, idx+1);
      }
    }, 900);
  }

  /* PS2 Essentials images injection (robust) */
  (function renderPS2Images(){
    const row = document.getElementById('ps2-imgrow');
    const mapped = imageMap['PS2-essentials'] || imageMap['PS2-essentials'.replace(/\s+/g,'')] || null;
    if(!mapped) return;
    const candidatesList = candidatesFor(mapped);
    // We'll create one <img> per original mapping item, but each will try candidates for that item
    const originalList = Array.isArray(mapped) ? mapped : [mapped];
    originalList.forEach(item => {
      const img = document.createElement('img');
      img.alt = item;
      img.style.display = 'none';
      img.width = 160;
      row.appendChild(img);
      tryLoadImageElement(img, candidatesFor(item));
    });
  })();

  /* Sidebar helpers */
  function getChecked(name){
    return Array.from(document.querySelectorAll('input[name="'+name+'"]:checked')).map(i=>i.value);
  }
  function withinBand(price, band){
    const [lo,hi]=band.split('-').map(Number);
    return price>=lo && price<=hi;
  }

  /* renderCatalog with image support */
  function renderCatalog(){
    const grid = document.getElementById('productGrid'); if(!grid) return;
    grid.innerHTML='';

    const priceBands = getChecked('price');
    const cats = getChecked('category');
    const types = getChecked('type');

    function productPasses(p){
      const passCat = cats.length? cats.includes(p.category): true;
      const passTyp = types.length? types.includes(p.type): true;
      if(!passCat || !passTyp) return false;
      if(priceBands.length===0) return true;
      return p.variants.some(v => priceBands.some(b => withinBand(v.price,b)));
    }

    catalog.forEach(p=>{
      if(!productPasses(p)) return;
      const chosenVariants = (priceBands.length===0) ? p.variants : p.variants.filter(v => priceBands.some(b => withinBand(v.price,b)));
      if(chosenVariants.length===0) return;

      const card = document.createElement('section'); card.className='card';

      // image
      const key = p.name;
      const mapped = imageMap[key] || imageMap[key.replace(/\s*\(.*\)$/,'')] || imageMap[key.split(' ')[0]] || null;
      if(mapped){
        const imgDiv = document.createElement('div'); imgDiv.className='imgrow';
        const img = document.createElement('img');
        img.alt = p.name;
        img.style.display = 'none';
        img.width = 160;
        imgDiv.appendChild(img);
        card.appendChild(imgDiv);
        tryLoadImageElement(img, candidatesFor(mapped));
      }

      // header / variants
      const head = document.createElement('div'); head.className='row';
      const nm = document.createElement('div'); nm.className='name'; nm.textContent = p.name;
      const variants = document.createElement('div'); variants.className='variantline';
      chosenVariants.forEach(v=>{
        const b = document.createElement('button'); b.className='btn buy'; b.textContent = `Buy Now ‚Ä¢ ${fmt(v.price)}`;
        b.addEventListener('click', ()=> goPrefill(p.name, v.name, v.price, 'Top'));
        variants.appendChild(b);
      });
      head.appendChild(nm); head.appendChild(variants);
      card.appendChild(head);

      // video links if any
      if(window.videoMap && window.videoMap[p.name]){
        const vids = document.createElement('div'); vids.className='variantline';
        window.videoMap[p.name].forEach(v=>{
          const a = document.createElement('a'); a.className='btn link'; a.textContent = v.label;
          a.href = v.url; a.target = "_blank"; a.rel="noopener";
          vids.appendChild(a);
        });
        card.appendChild(vids);
      }

      grid.appendChild(card);
    });

    if(!grid.children.length){
      const empty = document.createElement('div'); empty.className='card';
      empty.innerHTML = '<div class="muted">No products match the selected filters.</div>';
      grid.appendChild(empty);
    }
  }

  /* build policy apply-lines */
  function buildApplyLines(){
    const fmcbApply = document.getElementById('apply-fmcb');
    const mediaApply = document.getElementById('apply-media');
    const consolesApply = document.getElementById('apply-consoles');
    const accApply = document.getElementById('apply-accessories');
    if(!fmcbApply || !mediaApply || !consolesApply || !accApply) return;

    fmcbApply.textContent = "Applies to: PS2 Essentials ‚Äî FMCB, Games USB, FMCB + USB Combo";
    mediaApply.textContent = "Applies to: USB for PlayStation 2 ‚Äî Game-Loaded, FMCB + USB Combo for PS2";

    const consoleNames = catalog
      .filter(p=> p.category==='Gamestick' || p.category==='Gamebox' || p.type==='Handheld')
      .map(p=>p.name).join(', ');
    consolesApply.textContent = "Applies to: " + consoleNames;

    const accNames = catalog.filter(p=> p.category==='Accessories').map(p=> p.name).join(', ');
    accApply.textContent = "Applies to: " + accNames;
  }

  /* wire buttons */
  document.getElementById('applyFilters')?.addEventListener('click', renderCatalog);
  document.getElementById('resetFilters')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[type="checkbox"]').forEach(c=> c.checked=false);
    renderCatalog();
  });
  document.getElementById('clearPrice')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="price"]').forEach(c=> c.checked=false);
  });
  document.getElementById('clearCategory')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="category"]').forEach(c=> c.checked=false);
  });
  document.getElementById('clearType')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="type"]').forEach(c=> c.checked=false);
  });

  /* initial render */
  renderCatalog();
  buildApplyLines();

  console.info('Image loader active. If any images fail to appear, open DevTools ‚Üí Console to see missing filenames and candidate paths attempted.');
});
</script>
</body>
</html>
