<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Games Planet — Order</title>
<meta name="description" content="Games Planet order page with overlay filters, per-product videos, and grouped policies."/>
<style>
:root{
  --bg:#0b1020; --panel:#0f1530; --card:#121a33; --muted:#9fb0d3; --text:#eaf1ff;
  --accent:#7c4dff; --accent2:#3ddc84; --chip:#1b2447; --shadow:0 10px 30px rgba(0,0,0,.35);
}
@media(prefers-color-scheme:light){:root{--bg:#f7f8ff;--panel:#eef2ff;--card:#ffffff;--text:#0b1020;--muted:#51607e;--chip:#e7ebff;--shadow:0 8px 20px rgba(11,16,32,.08)}}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(60vw 60vw at 10% -10%, rgba(124,77,255,.20), transparent 40%),
    radial-gradient(50vw 50vw at 110% 10%, rgba(61,220,132,.20), transparent 40%),
    var(--bg);
  color:var(--text);
  scrollbar-gutter: stable both-edges;
  overflow-x:hidden;
  word-wrap:break-word;
  overflow-wrap:anywhere;
}

/* Header / Brand */
.topbar{
  position:sticky; top:0; z-index:55;
  backdrop-filter:saturate(120%) blur(8px);
  background:linear-gradient(180deg,rgba(0,0,0,.35),transparent);
  border-bottom:1px solid rgba(255,255,255,.08);
}
.brand{
  max-width:1300px; margin:0 auto; padding:14px 18px;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
}
.brand .left{display:flex; align-items:center; gap:10px}
.logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;font-weight:900;background:linear-gradient(135deg,var(--accent),#5ecbff);color:#fff;box-shadow:var(--shadow)}
.brand h1{font-size:clamp(18px,2.6vw,26px); margin:0}
.brand .sub{font-size:12px;color:var(--muted)}

.app{max-width:1300px;margin:0 auto;padding:18px 18px 120px}
.togglebar{position:fixed;top:76px;left:12px;z-index:60;display:flex;gap:8px}
.tbtn{border:0;background:var(--accent);color:#fff;padding:10px 12px;border-radius:12px;box-shadow:var(--shadow);font-weight:800;cursor:pointer;white-space:normal;line-height:1.1}
.tbtn.secondary{background:var(--chip);color:var(--text)}

/* Overlay Sidebar (blurred + transparent like header) */
.sidebar{
  position:fixed; top:0; left:0; height:100vh; width:320px; max-width:86vw;
  background:rgba(17,24,48,.55);
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  border-right:1px solid rgba(255,255,255,.12);
  box-shadow:var(--shadow); z-index:70; overflow:auto;
  transform:translateX(-100%); transition:transform .25s ease;
  padding:14px 14px 18px;
}
.sidebar.open{transform:translateX(0)}
.backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.4); z-index:65; display:none;
}
.backdrop.show{display:block}
.sb-head{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:8px}
.sb-title{font-weight:900;letter-spacing:.06em;text-transform:uppercase;color:#dbe4ff;font-size:13px}
.sb-close{border:0;background:rgba(255,255,255,.12);color:#fff;padding:8px 10px;border-radius:10px;font-weight:800;cursor:pointer}

/* Cards */
.card{background:var(--card);border-radius:18px;padding:16px;box-shadow:var(--shadow);position:relative;overflow:hidden;margin-bottom:18px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:var(--chip);color:var(--muted);border-radius:999px;font-size:12px;font-weight:700;margin-right:6px}
.title{margin:8px 0 6px;font-size:18px}
.muted{color:var(--muted);font-size:14px}
.grid{display:flex;flex-direction:column;gap:12px}

/* Products */
.row{display:grid;grid-template-columns:minmax(140px,1fr) auto;gap:8px;align-items:center}
.name{font-weight:800;min-width:0}
.variantline{
  display:flex;gap:8px;flex-wrap:wrap;
  white-space:normal;
  padding-bottom:4px;max-width:100%;
}
.btn{
  border:0;padding:9px 12px;border-radius:12px;font-weight:800;cursor:pointer;flex:0 1 auto;
  white-space:normal; line-height:1.12;text-align:center;min-width:96px;max-width:100%;
}
.btn.buy{background:var(--accent2);color:#08210f}
.btn.link{background:var(--chip);color:var(--text)}

/* Filters */
.fh{font-size:13px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin:8px 0 6px}
.fgroup{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
.chk{display:flex;align-items:center;gap:8px}
.chk input{accent-color:var(--accent)}
.clearbox{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.small{font-size:12px;color:var(--muted)}

/* Images */
.imgrow{display:flex;gap:12px;flex-wrap:wrap;margin:8px 0}
.imgrow img{border-radius:12px;box-shadow:var(--shadow);max-height:90px;height:auto;width:auto}

/* Policy blocks */
.policyblock{background:var(--card);border-radius:18px;padding:16px;box-shadow:var(--shadow);margin-bottom:18px}
.policyblock h3{margin:0 0 6px}
.applyline{font-size:12px;color:var(--muted);white-space:normal;overflow:visible}
ul.tight{margin:8px 0 0 18px}

/* Footer */
.foot{opacity:.85;margin-top:24px;font-size:12px;color:var(--muted);text-align:center}
</style>
</head>
<body>

<header class="topbar">
  <div class="brand">
    <div class="left">
      <div class="logo">GP</div>
      <div>
        <h1>Games Planet</h1>
        <div class="sub">Retro Consoles • GameSticks • PS2 Media</div>
      </div>
    </div>
    <div class="right" style="display:flex;gap:8px;align-items:center">
      <a href="https://wa.me/917983624797?text=I%20want%20to%20order%20from%20Games%20Planet" class="tbtn secondary" target="_blank" rel="noopener">WhatsApp</a>
    </div>
  </div>
</header>

<div class="togglebar">
  <button class="tbtn" id="toggleSidebar">☰ Filters</button>
</div>

<!-- Overlay Sidebar + Backdrop -->
<div class="sidebar" id="sidebar">
  <div class="sb-head">
    <div class="sb-title">Filters</div>
    <button class="sb-close" id="closeSidebarTop" type="button">✖ Close</button>
  </div>
  <hr style="border:none;border-top:1px dashed rgba(255,255,255,.18);margin:8px 0 12px" />

  <div class="fgroup">
    <div class="fh">Price Band</div>
    <label class="chk"><input type="checkbox" name="price" value="0-1000"> ₹0–₹1000</label>
    <label class="chk"><input type="checkbox" name="price" value="1000-2000"> ₹1000–₹2000</label>
    <label class="chk"><input type="checkbox" name="price" value="2000-3000"> ₹2000–₹3000</label>
    <label class="chk"><input type="checkbox" name="price" value="3000-4000"> ₹3000–₹4000</label>
    <label class="chk"><input type="checkbox" name="price" value="4000-5000"> ₹4000–₹5000</label>
    <label class="chk"><input type="checkbox" name="price" value="5000-6000"> ₹5000–₹6000</label>
    <label class="chk"><input type="checkbox" name="price" value="6000-7000"> ₹6000–₹7000</label>
    <label class="chk"><input type="checkbox" name="price" value="7000-8000"> ₹7000–₹8000</label>
    <label class="chk"><input type="checkbox" name="price" value="8000-9000"> ₹8000–₹9000</label>
    <label class="chk"><input type="checkbox" name="price" value="9000-10000"> ₹9000–₹10000</label>
    <label class="chk"><input type="checkbox" name="price" value="10000-11000"> ₹10000–₹11000</label>
    <label class="chk"><input type="checkbox" name="price" value="11000-12000"> ₹11000–₹12000</label>
    <label class="chk"><input type="checkbox" name="price" value="12000-13000"> ₹12000–₹13000</label>
    <div class="clearbox">
      <button class="tbtn secondary" id="clearPrice" type="button">Clear Price</button>
    </div>
  </div>

  <div class="fgroup">
    <div class="fh">Category</div>
    <label class="chk"><input type="checkbox" name="category" value="Gamebox"> Gamebox</label>
    <label class="chk"><input type="checkbox" name="category" value="Gamestick"> Gamestick</label>
    <label class="chk"><input type="checkbox" name="category" value="Renewed"> Renewed consoles</label>
    <label class="chk"><input type="checkbox" name="category" value="Accessories"> Accessories</label>
    <div class="clearbox">
      <button class="tbtn secondary" id="clearCategory" type="button">Clear Category</button>
    </div>
  </div>

  <div class="fgroup">
    <div class="fh">Type</div>
    <label class="chk"><input type="checkbox" name="type" value="Game+Android"> Game + Android</label>
    <label class="chk"><input type="checkbox" name="type" value="GameOnly"> Game only</label>
    <label class="chk"><input type="checkbox" name="type" value="Handheld"> Handheld</label>
    <label class="chk"><input type="checkbox" name="type" value="Accessories"> Accessories</label>
    <div class="clearbox">
      <button class="tbtn secondary" id="clearType" type="button">Clear Type</button>
    </div>
  </div>

  <div class="clearbox" style="margin-bottom:6px">
    <button class="tbtn" id="applyFilters" type="button">Apply Filters</button>
    <button class="tbtn secondary" id="resetFilters" type="button">Reset All</button>
  </div>

  <div class="small">Tip: Multiple boxes select kar sakte ho. Koi selection na ho to sab products dikhte hain.</div>
</div>
<div class="backdrop" id="backdrop"></div>

<div class="app">
  <main class="content">
    <!-- FMCB (no setup button here per your instruction) -->
    <section class="card">
      <span class="badge">FMCB / FunTuna Card</span>
      <h2 class="title">Memory Card for PS2 (Model-wise)</h2>
      <div class="imgrow"><img src="Fmcb.png" alt="FMCB 8MB Memory Card"></div>
      <div class="muted">Boot PS2 games from USB using preconfigured FMCB / FunTuna + OPL. Choose your model:</div>
      <div class="grid" id="fmcbCard"></div>
    </section>

    <!-- USB Only (includes Setup Video with YouTube icon) -->
    <section class="card">
      <span class="badge">USB Only</span>
      <h2 class="title">USB for PlayStation 2 — Game-Loaded</h2>
      <div class="imgrow"><img src="Usb.jpg" alt="USB"><img src="Usbhdd.jpeg" alt="USB HDD"></div>
      <div class="muted">Requires FMCB card + latest OPL. Plug directly into PS2 (no hub/splitter).</div>
      <div class="grid" id="usbList"></div>
      <div class="variantline" style="margin-top:8px">
        <a class="btn link" href="https://youtu.be/xGR0vUM1-Jw" target="_blank" rel="noopener">▶️ YouTube • Setup / Game List</a>
        <a class="btn link" href="https://gamesplanet13.github.io/ps2gameselector/" target="_blank" rel="noopener">🟨 Games Selector</a>
      </div>
    </section>

    <!-- Combo (includes Setup Video with YouTube icon) -->
    <section class="card">
      <span class="badge">Combo Best Value</span>
      <h2 class="title">FMCB + USB Combo for PS2</h2>
      <div class="imgrow"><img src="Fmcb.png" alt="FMCB"><img src="Usb.jpg" alt="USB"><img src="Usbhdd.jpeg" alt="HDD"></div>
      <div class="muted">Fully Plug & Play. Works on PS2 Fat, Slim 7xxxx (FMCB) & Slim 9xxxx (FunTuna).</div>
      <div class="grid" id="comboList"></div>
      <div class="variantline" style="margin-top:8px">
        <a class="btn link" href="https://youtu.be/xGR0vUM1-Jw" target="_blank" rel="noopener">▶️ YouTube • Setup / Game List</a>
        <a class="btn link" href="https://gamesplanet13.github.io/ps2gameselector/" target="_blank" rel="noopener">🟨 Games Selector</a>
      </div>
    </section>

    <!-- Filtered Catalog -->
    <section class="card">
      <span class="badge">Catalog</span>
      <h2 class="title">Products</h2>
      <div class="grid" id="productGrid"></div>
    </section>

    <!-- Consolidated Policy Blocks (updated emojis + 3 days return) -->
    <section class="policyblock" id="policy-fmcb">
      <h3>Policy — FMCB / FunTuna (PS2 Memory Card)</h3>
      <div class="applyline" id="apply-fmcb"></div>
      <ul class="tight">
        <li>🚫 No Return • 🚫 No Replacement • 🚫 No Refund</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-media">
      <h3>Policy — PS2 Media (USB / SSD / HDD)</h3>
      <div class="applyline" id="apply-media"></div>
      <ul class="tight">
        <li>🚫 No Return • 🚫 No Replacement • 🚫 No Refund</li>
        <li>🛡️ Warranty (media only): 64GB / 128GB / 128GB SSD – 1 Year; 256GB / 500GB SSD – 1 Year; 500GB HDD – 6 Months; USB enclosure – No Warranty</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-consoles">
      <h3>Policy — Handheld Consoles, Gamestick & Gamebox</h3>
      <div class="applyline" id="apply-consoles"></div>
      <ul class="tight">
        <li>🔁 3 Days Replacement</li>
        <li>↩️ 3 Days Returnable — 70% refund (within replacement window)</li>
        <li>🛠️ 1 Month Software Warranty / Reinstallation (1-side courier charge by customer)</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-accessories">
      <h3>Policy — Accessories</h3>
      <div class="applyline" id="apply-accessories"></div>
      <ul class="tight">
        <li>🚫 No Warranty • 🚫 No Return • 🚫 No Replacement • 🚫 No Refund</li>
      </ul>
    </section>

    <div class="foot">© Games Planet — WhatsApp: +91 79836 24797 • Prices in INR.</div>
  </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const fmt = n => "₹"+Number(n).toLocaleString("en-IN");
  function goPrefill(product,variant,base,pack){
    const q=new URLSearchParams({product,variant,base,pack});
    location.href='order-prefill.html?'+q.toString();
  }

  /* Overlay sidebar */
  const sidebar = document.getElementById('sidebar');
  const backdrop = document.getElementById('backdrop');
  const toggleBtn = document.getElementById('toggleSidebar');
  const closeTop = document.getElementById('closeSidebarTop');
  function openSB(){ sidebar?.classList.add('open'); backdrop?.classList.add('show'); }
  function closeSB(){ sidebar?.classList.remove('open'); backdrop?.classList.remove('show'); }
  toggleBtn?.addEventListener('click', ()=> sidebar?.classList.contains('open') ? closeSB() : openSB());
  backdrop?.addEventListener('click', closeSB);
  closeTop?.addEventListener('click', closeSB);

  /* Catalog data */
  const catalog = [
    // Gamebox
    { name:"GameBox G11 Pro (Regular)", category:"Gamebox", type:"Game+Android",
      variants:[{name:"64GB", price:4599},{name:"128GB", price:6599},{name:"256GB", price:7599}] },
    { name:"GameBox Plus G10 (Vayava)", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:3599}] },
    { name:"GD35 (Vayava)", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:5299},{name:"128GB", price:6999},{name:"256GB", price:7999}] },
    { name:"GD35 GTA San Andreas HD Edition", category:"Gamebox", type:"GameOnly",
      variants:[{name:"64GB", price:5999},{name:"128GB", price:7699},{name:"256GB", price:8699}] },

    // Gamestick
    { name:"Gamestick Lite (Pandora Mini M8)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:1599}] },
    { name:"Gamestick Pro (Pandora Pro M15)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:1899}] },
    { name:"Gamestick GD10 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:2399},{name:"128GB", price:4399}] },
    { name:"GPZ M33", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:2699},{name:"128GB", price:4999},{name:"256GB", price:5999}] },
    { name:"GPZ M22", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3499},{name:"128GB", price:5999},{name:"256GB", price:6999}] },
    { name:"GPZ M55", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3499},{name:"128GB", price:5999},{name:"256GB", price:6999}] },
    { name:"Gamestick GS5 Mini", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3699},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v1 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3599},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v2 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3599},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick GD30 v3 (Vayava)", category:"Gamestick", type:"GameOnly",
      variants:[{name:"64GB", price:3699},{name:"128GB", price:5999},{name:"256GB", price:7299}] },
    { name:"Gamestick M88", category:"Gamestick", type:"GameOnly",
      variants:[{name:"128GB", price:7799}] },

    // Accessories
    { name:"Wireless Controller for PS4 Compatible (Black)", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:1699}] },
    { name:"P5 Wireless Controller for PS4 Compatible", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:1899}] },
    { name:"P5 Spider Man Theme Controller (PS4 Compatible)", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:1999}] },
    { name:"Wired Controller for PS2 Compatible (Black)", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:549}] },
    { name:"Wireless Controller for PS2 Compatible", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:749}] },
    { name:"Wireless Controller for PS3 Compatible (Black)", category:"Accessories", type:"Accessories",
      variants:[{name:"STD", price:1399}] },
  ];

  /* Per-product videos (now show YouTube icon on every video button) */
  const videoMap = {
    "GD35 (Vayava)": [
      {label:"▶️ YouTube • Unboxing", url:"https://youtu.be/v1k6gJtREfk?si=3RHYWRwmI34bxxlv"},
      {label:"▶️ YouTube • Gameplay Guide", url:"https://youtu.be/-6jDWfplmkY?si=o90IJTPaEZaCyZhd"}
    ],
    "GD35 GTA San Andreas HD Edition": [
      {label:"▶️ YouTube • Unboxing", url:"https://youtu.be/v1k6gJtREfk?si=3RHYWRwmI34bxxlv"},
      {label:"▶️ YouTube • Gameplay Guide", url:"https://youtu.be/-6jDWfplmkY?si=o90IJTPaEZaCyZhd"}
    ],
    "GameBox G11 Pro (Regular)": [
      {label:"▶️ YouTube • Unboxing", url:"https://youtu.be/kJNJ_Kq3NvA?si=C-_ekj4Qna4LzO-s"},
      {label:"▶️ YouTube • Connection Guide", url:"https://youtu.be/HoRVcbKb77Q?si=X3oSNCYncTLqos-s"},
      {label:"▶️ YouTube • Special Edition Demo", url:"https://youtu.be/ILHGhkGNJ2s?si=h-4AWK2YRsPRcvIc"}
    ],
    "GameBox Plus G10 (Vayava)": [
      {label:"▶️ YouTube • Unboxing & Testing", url:"https://youtu.be/EGoVlcrre18?si=e5FMmoFI9eMnSMpt"},
      {label:"▶️ YouTube • Connection & Setup", url:"https://youtu.be/l1uVzH-JWgs?si=pehPyGDR5cNQhOJY"}
    ],
    "GPZ M55": [
      {label:"▶️ YouTube • Unboxing", url:"https://youtu.be/uMkSclSP5kA?si=zChWREgvdXYk-Gm0"}
    ],
    "GPZ M22": [
      {label:"▶️ YouTube • Unboxing & Demo", url:"https://youtu.be/bEt1GvDk8JY?si=Ki1TEJNqdiJvOLUM"},
      {label:"▶️ YouTube • Gameplay Testing", url:"https://youtu.be/TnLw-wLWJ6A?si=8wnMnJFpA_AKbhAs"}
    ],
    "GPZ M33": [
      {label:"▶️ YouTube • Unboxing-1", url:"https://youtu.be/h838JHwNI1k?si=Vo-BL1MWqTo4gF8i"},
      {label:"▶️ YouTube • Unboxing-2", url:"https://youtu.be/0dW4go5qaDQ?si=erLso2WIpbUNj0gp"},
      {label:"▶️ YouTube • Gameplay Testing", url:"https://youtu.be/TnLw-wLWJ6A?si=8wnMnJFpA_AKbhAs"}
    ]
  };
  window.videoMap = videoMap;

  /* PS2 quick-purchase blocks */
  const fmcbModels = [
    { label:'PS2 Fat (All Models) — FMCB', price:999 },
    { label:'PS2 Slim 7xxxx (All) — FMCB', price:999 },
    { label:'PS2 Slim 9xxxx (All) — FunTuna', price:999 },
  ];
  const usbVariants = [
    { v:'64GB PD',   top:  999, opt: 1099 },
    { v:'128GB PD',  top: 1499, opt: 1649 },
    { v:'128GB SSD', top: 1999, opt: 2199 },
    { v:'256GB SSD', top: 2999, opt: 3299 },
    { v:'500GB HDD', top: 2999, opt: 3299 },
    { v:'500GB SSD', top: 3999, opt: 4399 },
  ];
  const comboVariants = [
    { v:'64GB PD',   top: 1499, opt: 1649, count:21 },
    { v:'128GB PD',  top: 1999, opt: 2199, count:41 },
    { v:'128GB SSD', top: 2499, opt: 2699, count:41 },
    { v:'256GB SSD', top: 3499, opt: 3849, count:71 },
    { v:'500GB HDD', top: 3699, opt: 4049, count:175 },
    { v:'500GB SSD', top: 4699, opt: 5149, count:175 },
  ];

  /* Renderers */
  function renderFMCB(){
    const box=document.getElementById('fmcbCard'); if(!box) return;
    box.innerHTML='';
    fmcbModels.forEach(({label,price})=>{
      const line=document.createElement('div'); line.className='row';
      const name=document.createElement('div'); name.className='name'; name.textContent=label;
      const variants=document.createElement('div'); variants.className='variantline';
      const b=document.createElement('button'); b.className='btn buy'; b.textContent=`Buy Now • ${fmt(price)}`;
      b.addEventListener('click', ()=> goPrefill('Memory Card', label, price, 'Card Only'));
      variants.appendChild(b);
      line.appendChild(name); line.appendChild(variants); box.appendChild(line);
    });
  }
  function renderUSB(){
    const box=document.getElementById('usbList'); if(!box) return;
    box.innerHTML='';
    usbVariants.forEach(({v,top,opt})=>{
      const line=document.createElement('div'); line.className='row';
      const name=document.createElement('div'); name.className='name'; name.textContent=v;
      const variants=document.createElement('div'); variants.className='variantline';
      const b1=document.createElement('button'); b1.className='btn buy'; b1.textContent=`Buy Now • Top • ${fmt(top)}`;
      b1.addEventListener('click', ()=> goPrefill('USB for PS2 (Game-Loaded)', v, top, 'Top'));
      const b2=document.createElement('button'); b2.className='btn buy'; b2.textContent=`Buy Now • Optional • ${fmt(opt)}`;
      b2.addEventListener('click', ()=> goPrefill('USB for PS2 (Game-Loaded)', v+' — Optional', opt, 'Optional'));
      variants.appendChild(b1); variants.appendChild(b2);
      line.appendChild(name); line.appendChild(variants); box.appendChild(line);
    });
  }
  function renderCombo(){
    const box=document.getElementById('comboList'); if(!box) return;
    box.innerHTML='';
    comboVariants.forEach(({v,top,opt,count})=>{
      const line=document.createElement('div'); line.className='row';
      const name=document.createElement('div'); name.className='name'; name.innerHTML=`${v} <span style="opacity:.7;font-size:12px;margin-left:6px">Top ${count}</span>`;
      const variants=document.createElement('div'); variants.className='variantline';
      const b1=document.createElement('button'); b1.className='btn buy'; b1.textContent=`Buy Now • Top • ${fmt(top)}`;
      b1.addEventListener('click', ()=> goPrefill('FMCB + USB Combo for PS2', v, top, 'Top'));
      const b2=document.createElement('button'); b2.className='btn buy'; b2.textContent=`Buy Now • Optional • ${fmt(opt)}`;
      b2.addEventListener('click', ()=> goPrefill('FMCB + USB Combo for PS2', v+' — Optional', opt, 'Optional'));
      variants.appendChild(b1); variants.appendChild(b2);
      line.appendChild(name); line.appendChild(variants); box.appendChild(line);
    });
  }

  /* Sidebar checkbox helpers */
  function getChecked(name){
    return Array.from(document.querySelectorAll('input[name="'+name+'"]:checked')).map(i=>i.value);
  }
  function withinBand(price, band){
    const [lo,hi]=band.split('-').map(Number);
    return price>=lo && price<=hi;
  }

  /* Render filtered catalog with per-product video buttons (YouTube icon on all) */
  function renderCatalog(){
    const grid = document.getElementById('productGrid'); if(!grid) return;
    grid.innerHTML='';

    const priceBands = getChecked('price'); // [] means all
    const cats = getChecked('category');
    const types = getChecked('type');

    function productPasses(p){
      const passCat = cats.length? cats.includes(p.category): true;
      const passTyp = types.length? types.includes(p.type): true;
      if(!passCat || !passTyp) return false;
      if(priceBands.length===0) return true;
      return p.variants.some(v => priceBands.some(b => withinBand(v.price,b)));
    }

    const videoMapLocal = window.videoMap || {};
    catalog.forEach(p=>{
      if(!productPasses(p)) return;
      const chosenVariants = (priceBands.length===0)
        ? p.variants
        : p.variants.filter(v => priceBands.some(b => withinBand(v.price,b)));
      if(chosenVariants.length===0) return;

      const card=document.createElement('section'); card.className='card';
      const head=document.createElement('div'); head.className='row';
      const nm=document.createElement('div'); nm.className='name'; nm.textContent=p.name;
      const variants=document.createElement('div'); variants.className='variantline';
      chosenVariants.forEach(v=>{
        const b=document.createElement('button'); b.className='btn buy'; b.textContent=`Buy Now • ${fmt(v.price)}`;
        b.addEventListener('click', ()=> goPrefill(p.name, v.name, v.price, 'Top'));
        variants.appendChild(b);
      });
      head.appendChild(nm); head.appendChild(variants);
      card.appendChild(head);

      if(videoMapLocal[p.name]){
        const vids=document.createElement('div'); vids.className='variantline';
        videoMapLocal[p.name].forEach(v=>{
          const a=document.createElement('a'); a.className='btn link'; a.textContent=v.label; // already includes ▶️ YouTube
          a.href=v.url; a.target="_blank"; a.rel="noopener";
          vids.appendChild(a);
        });
        card.appendChild(vids);
      }

      grid.appendChild(card);
    });

    if(!grid.children.length){
      const empty=document.createElement('div'); empty.className='card';
      empty.innerHTML='<div class="muted">No products match the selected filters.</div>';
      grid.appendChild(empty);
    }
  }

  /* Build bottom policy apply-lines (comma-separated, no chips) */
  function buildApplyLines(){
    const fmcbApply = document.getElementById('apply-fmcb');
    const mediaApply = document.getElementById('apply-media');
    const consolesApply = document.getElementById('apply-consoles');
    const accApply = document.getElementById('apply-accessories');
    if(!fmcbApply || !mediaApply || !consolesApply || !accApply) return;

    fmcbApply.textContent = "Applies to: Memory Card for PS2 (Model-wise)";
    mediaApply.textContent = "Applies to: USB for PlayStation 2 — Game-Loaded, FMCB + USB Combo for PS2";

    const consoleNames = catalog
      .filter(p=> p.category==='Gamestick' || p.category==='Gamebox' || p.type==='Handheld')
      .map(p=>p.name).join(', ');
    consolesApply.textContent = "Applies to: " + consoleNames;

    const accNames = catalog.filter(p=> p.category==='Accessories').map(p=>p.name).join(', ');
    accApply.textContent = "Applies to: " + accNames;
  }

  /* Wire filter buttons */
  document.getElementById('applyFilters')?.addEventListener('click', renderCatalog);
  document.getElementById('resetFilters')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[type="checkbox"]').forEach(c=> c.checked=false);
    renderCatalog();
  });
  document.getElementById('clearPrice')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="price"]').forEach(c=> c.checked=false);
  });
  document.getElementById('clearCategory')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="category"]').forEach(c=> c.checked=false);
  });
  document.getElementById('clearType')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[name="type"]').forEach(c=> c.checked=false);
  });

  /* Initial renders */
  renderFMCB();
  renderUSB();
  renderCombo();
  renderCatalog();
  buildApplyLines();
});
</script>
</body>
</html>
