# Writing the patched index.html to /mnt/data/index_patched.html
html_content = r'''<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Games Planet ‚Äî Order (Updated)</title>
<meta name="description" content="Games Planet order page ‚Äî updated catalog, buy links, WhatsApp buy buttons and video links."/>
<style>
:root{
  --bg:#0b1020; --panel:#0f1530; --card:#121a33; --muted:#9fb0d3; --text:#eaf1ff;
  --accent:#7c4dff; --accent2:#3ddc84; --chip:#1b2447; --shadow:0 10px 30px rgba(0,0,0,.35);
}
@media(prefers-color-scheme:light){:root{--bg:#f7f8ff;--panel:#eef2ff;--card:#ffffff;--text:#0b1020;--muted:#51607e;--chip:#e7ebff;--shadow:0 8px 20px rgba(11,16,32,.08)}}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(60vw 60vw at 10% -10%, rgba(124,77,255,.20), transparent 40%),
    radial-gradient(50vw 50vw at 110% 10%, rgba(61,220,132,.20), transparent 40%),
    var(--bg);
  color:var(--text);
  scrollbar-gutter: stable both-edges;
  overflow-x:hidden;
  word-wrap:break-word;
  overflow-wrap:anywhere;
}

/* layout */
.topbar{ position:sticky; top:0; z-index:55; backdrop-filter:saturate(120%) blur(8px);
  background:linear-gradient(180deg,rgba(0,0,0,.35),transparent); border-bottom:1px solid rgba(255,255,255,.08);
}
.brand{ max-width:1300px; margin:0 auto; padding:14px 18px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
.logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;font-weight:900;background:linear-gradient(135deg,var(--accent),#5ecbff);color:#fff;box-shadow:var(--shadow)}
.brand h1{font-size:clamp(18px,2.6vw,26px); margin:0}
.brand .sub{font-size:12px;color:var(--muted)}

.app{max-width:1300px;margin:0 auto;padding:18px 18px 120px}
.togglebar{position:fixed;top:76px;left:12px;z-index:60;display:flex;gap:8px}
.tbtn{border:0;background:var(--accent);color:#fff;padding:10px 12px;border-radius:12px;box-shadow:var(--shadow);font-weight:800;cursor:pointer;white-space:normal;line-height:1.1}
.tbtn.secondary{background:var(--chip);color:var(--text)}

.sidebar{ position:fixed; top:0; left:0; height:100vh; width:320px; max-width:86vw; background:rgba(17,24,48,.55); backdrop-filter: blur(12px) saturate(140%); -webkit-backdrop-filter: blur(12px) saturate(140%); border-right:1px solid rgba(255,255,255,.12); box-shadow:var(--shadow); z-index:70; overflow:auto; transform:translateX(-100%); transition:transform .25s ease; padding:14px 14px 18px; }
.sidebar.open{transform:translateX(0)}
.backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.4); z-index:65; display:none; }
.backdrop.show{display:block}

.card{background:var(--card);border-radius:18px;padding:16px;box-shadow:var(--shadow);position:relative;overflow:hidden;margin-bottom:18px}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;background:var(--chip);color:var(--muted);border-radius:999px;font-size:12px;font-weight:700;margin-right:6px}
.title{margin:8px 0 6px;font-size:18px}
.muted{color:var(--muted);font-size:14px}
.grid{display:flex;flex-direction:column;gap:12px}

.row{display:grid;grid-template-columns:minmax(140px,1fr) auto;gap:8px;align-items:center}
.name{font-weight:800;min-width:0}
.variantline{ display:flex;gap:8px;flex-wrap:wrap; white-space:normal; padding-bottom:4px;max-width:100%; }
.btn{ border:0;padding:9px 12px;border-radius:12px;font-weight:800;cursor:pointer;flex:0 1 auto; white-space:normal; line-height:1.12;text-align:center;min-width:96px;max-width:100%; }
.btn.buy{background:var(--accent2);color:#08210f}
.btn.link{background:var(--chip);color:var(--text)}
.btn.video{background:transparent;border:1px solid rgba(255,255,255,.06);color:var(--text)}

.fh{font-size:13px;letter-spacing:.06em;text-transform:uppercase;color:var(--muted);margin:8px 0 6px}
.fgroup{display:flex;flex-direction:column;gap:6px;margin-bottom:12px}
.chk{display:flex;align-items:center;gap:8px}
.chk input{accent-color:var(--accent)}
.clearbox{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.small{font-size:12px;color:var(--muted)}

.imgrow{display:flex;gap:12px;flex-wrap:wrap;margin:8px 0}
.imgrow img{border-radius:12px;box-shadow:var(--shadow);max-height:90px;height:auto;width:auto}

/* footer */
.foot{opacity:.85;margin-top:24px;font-size:12px;color:var(--muted);text-align:center}
.dev-hint{font-size:12px;color:var(--muted);margin-top:6px}
</style>
</head>
<body>
<header class="topbar">
  <div class="brand">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="logo">GP</div>
      <div>
        <h1>Games Planet</h1>
        <div class="sub">Retro Consoles ‚Ä¢ GameSticks ‚Ä¢ PS2 Media</div>
      </div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <a class="tbtn secondary" href="https://wa.me/917983624797?text=I%20want%20to%20order%20from%20Games%20Planet" target="_blank" rel="noopener">WhatsApp</a>
    </div>
  </div>
</header>

<div class="togglebar">
  <button class="tbtn" id="toggleSidebar">‚ò∞ Filters</button>
</div>

<div class="sidebar" id="sidebar">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
    <div style="font-weight:900;letter-spacing:.06em;text-transform:uppercase;color:#dbe4ff;font-size:13px">Filters</div>
    <button class="tbtn secondary" id="closeSidebarTop" type="button">‚úñ Close</button>
  </div>
  <hr style="border:none;border-top:1px dashed rgba(255,255,255,.18);margin:8px 0 12px" />
  <div class="fgroup">
    <div class="fh">Price Band</div>
    <label class="chk"><input type="checkbox" name="price" value="0-1000"> ‚Çπ0‚Äì‚Çπ1000</label>
    <label class="chk"><input type="checkbox" name="price" value="1000-2000"> ‚Çπ1000‚Äì‚Çπ2000</label>
    <label class="chk"><input type="checkbox" name="price" value="2000-3000"> ‚Çπ2000‚Äì‚Çπ3000</label>
    <label class="chk"><input type="checkbox" name="price" value="3000-4000"> ‚Çπ3000‚Äì‚Çπ4000</label>
    <label class="chk"><input type="checkbox" name="price" value="4000-5000"> ‚Çπ4000‚Äì‚Çπ5000</label>
    <label class="chk"><input type="checkbox" name="price" value="5000-6000"> ‚Çπ5000‚Äì‚Çπ6000</label>
    <label class="chk"><input type="checkbox" name="price" value="6000-7000"> ‚Çπ6000‚Äì‚Çπ7000</label>
  </div>
  <div class="fgroup">
    <div class="fh">Category</div>
    <label class="chk"><input type="checkbox" name="category" value="Gamebox"> Gamebox</label>
    <label class="chk"><input type="checkbox" name="category" value="Gamestick"> Gamestick</label>
    <label class="chk"><input type="checkbox" name="category" value="Handheld"> Handheld</label>
    <label class="chk"><input type="checkbox" name="category" value="Renewed"> Renewed consoles</label>
    <label class="chk"><input type="checkbox" name="category" value="Accessories"> Accessories</label>
  </div>
  <div class="fgroup">
    <div class="fh">Type</div>
    <label class="chk"><input type="checkbox" name="type" value="Game+Android"> Game + Android</label>
    <label class="chk"><input type="checkbox" name="type" value="GameOnly"> Game only</label>
    <label class="chk"><input type="checkbox" name="type" value="Handheld"> Handheld</label>
    <label class="chk"><input type="checkbox" name="type" value="Accessories"> Accessories</label>
  </div>
  <div class="clearbox" style="margin-bottom:6px">
    <button class="tbtn" id="applyFilters" type="button">Apply Filters</button>
    <button class="tbtn secondary" id="resetFilters" type="button">Reset All</button>
  </div>
  <div class="small">Tip: Multiple boxes select kar sakte ho. Koi selection na ho to sab products dikhte hain.</div>
</div>

<div class="backdrop" id="backdrop"></div>

<div class="app">
  <main class="content">

    <!-- PS2 Essentials combined card -->
    <section class="card" id="ps2-essentials-card">
      <span class="badge">PS2 Essentials</span>
      <h2 class="title">FMCB ‚Ä¢ Games USB ‚Ä¢ FMCB + USB Combo (PS2)</h2>
      <div class="imgrow" id="ps2-imgrow"></div>
      <div class="muted">Essential PS2 media: FMCB / FunTuna memory card, preloaded USB drives, combo packs and key accessories.</div>
      <div class="variantline" style="margin-top:10px">
        <a class="btn buy" id="ps2-buy" href="https://gamesplanet13.github.io/ps2fmcb/" target="_blank" rel="noopener">Buy Now ‚Ä¢ FMCB / Games USB / Combo</a>
      </div>
      <div class="dev-hint">(If images are missing: open browser DevTools ‚Üí Console to see missing filenames.)</div>
    </section>

    <!-- Catalog -->
    <section class="card">
      <span class="badge">Catalog</span>
      <h2 class="title">Products</h2>
      <div class="grid" id="productGrid"></div>
    </section>

    <!-- Policies -->
    <section class="policyblock" id="policy-fmcb">
      <h3>Policy ‚Äî FMCB / FunTuna (PS2 Memory Card)</h3>
      <div class="applyline" id="apply-fmcb"></div>
      <ul class="tight">
        <li>üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-media">
      <h3>Policy ‚Äî PS2 Media (USB / SSD / HDD)</h3>
      <div class="applyline" id="apply-media"></div>
      <ul class="tight">
        <li>üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
        <li>üõ°Ô∏è Warranty (media only): 64GB / 128GB / 128GB SSD ‚Äì 1 Year; 256GB / 500GB SSD ‚Äì 1 Year; 500GB HDD ‚Äì 6 Months; USB enclosure ‚Äì No Warranty</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-consoles">
      <h3>Policy ‚Äî Handheld Consoles, Gamestick & Gamebox</h3>
      <div class="applyline" id="apply-consoles"></div>
      <ul class="tight">
        <li>üîÅ 3 Days Replacement</li>
        <li>‚Ü©Ô∏è 3 Days Returnable ‚Äî 70% refund (within replacement window)</li>
        <li>üõ†Ô∏è 1 Month Software Warranty / Reinstallation (1-side courier charge by customer)</li>
      </ul>
    </section>

    <section class="policyblock" id="policy-accessories">
      <h3>Policy ‚Äî Accessories</h3>
      <div class="applyline" id="apply-accessories"></div>
      <ul class="tight">
        <li>üö´ No Warranty ‚Ä¢ üö´ No Return ‚Ä¢ üö´ No Replacement ‚Ä¢ üö´ No Refund</li>
      </ul>
    </section>

    <div class="foot">¬© Games Planet ‚Äî WhatsApp: +91 79836 24797 ‚Ä¢ Prices in INR.</div>

  </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const fmt = n => "‚Çπ"+Number(n).toLocaleString("en-IN");

  function goPrefill(product,variant,base,pack){
    const q=new URLSearchParams({product,variant,base,pack});
    location.href='order-prefill.html?'+q.toString();
  }

  /* Sidebar open/close */
  const sidebar = document.getElementById('sidebar');
  const backdrop = document.getElementById('backdrop');
  const toggleBtn = document.getElementById('toggleSidebar');
  const closeTop = document.getElementById('closeSidebarTop');
  function openSB(){ sidebar?.classList.add('open'); backdrop?.classList.add('show'); }
  function closeSB(){ sidebar?.classList.remove('open'); backdrop?.classList.remove('show'); }
  toggleBtn?.addEventListener('click', ()=> sidebar?.classList.contains('open') ? closeSB() : openSB());
  closeTop?.addEventListener('click', closeSB);
  backdrop?.addEventListener('click', closeSB);

  /* ------------------ CATALOG (final 39 products) ------------------ */
  const catalog = [
    /* Gamestick (16) */
    { name:"Gamestick GD10 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3599}]},
    { name:"Gamestick GS5 Mini", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3699},{name:"128GB", price:5999}]},
    { name:"Gamestick M88", category:"Gamestick", type:"GameOnly", variants:[{name:"128GB", price:7799}]},
    { name:"GD35 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:5299},{name:"128GB", price:6999}]},
    { name:"GD35 GTA San Andreas HD Edition (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:5999}]},
    { name:"GPZ GAMESTICK LITE (Pandora Mini M8)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:1599}]},
    { name:"GPZ GAMESTICK PRO (Pandora Pro M15 / P5)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:1899}]},
    { name:"GPZ GD30 (v1) (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3599}]},
    { name:"GPZ GD30 v2 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3599}]},
    { name:"GPZ GD30 v3 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3699}]},
    { name:"GPZ GD30 v3 Special Edition (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3999}]},
    { name:"GPZ M22 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3499},{name:"128GB", price:5999}]},
    { name:"GPZ M33 (Vayava)", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:2699},{name:"128GB", price:4999}]},
    { name:"GPZ M55", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:3499},{name:"128GB", price:5999}]},
    { name:"GPZ M66", category:"Gamestick", type:"GameOnly", variants:[{name:"64GB", price:0}]},
    { name:"GPZ M88", category:"Gamestick", type:"GameOnly", variants:[{name:"128GB", price:6699}]},

    /* GameBox (4) */
    { name:"GameBox G11 Pro (Regular)", category:"Gamebox", type:"Game+Android", variants:[{name:"64GB", price:4599},{name:"128GB", price:6599}]},
    { name:"GameBox G11 Pro (Special Edition)", category:"Gamebox", type:"Game+Android", variants:[{name:"64GB", price:5599}]},
    { name:"GameBox G11 Pro (GTA San Andreas Edition)", category:"Gamebox", type:"Game+Android", variants:[{name:"64GB", price:37000}]},
    { name:"GameBox Plus G10 (Vayava)", category:"Gamebox", type:"Game+Android", variants:[{name:"64GB", price:3599}]},

    /* Handheld (4) */
    { name:"R35S ‚Äî Handheld Retro Console", category:"Handheld", type:"Handheld", variants:[{name:"64GB", price:2799}]},
    { name:"R35s (Budget) ‚Äî Handheld", category:"Handheld", type:"Handheld", variants:[{name:"64GB", price:2799}]},
    { name:"R35s ‚Äî Handheld", category:"Handheld", type:"Handheld", variants:[{name:"64GB", price:3299}]},
    { name:"R36 Ultra ‚Äî Handheld", category:"Handheld", type:"Handheld", variants:[{name:"64GB", price:3999}]},

    /* Renewed / Legacy (4) */
    { name:"PlayStation 2 Slim (Renewed)", category:"Renewed", type:"Console", variants:[{name:"Unit", price:6000}]},
    { name:"PlayStation 3 ‚Äî Renewed (500GB)", category:"Renewed", type:"Console", variants:[{name:"Unit", price:0}]},
    { name:"PS3 Superslim 250GB", category:"Renewed", type:"Console", variants:[{name:"Unit", price:0}]},
    { name:"PS4 Slim 1TB ‚Äî GTA5 Bundle (console bundle)", category:"Renewed", type:"Console", variants:[{name:"Unit", price:0}]},

    /* Accessories (11) */
    { name:"G11 Pro USB SSD (preloaded)", category:"Accessories", type:"Accessories", variants:[{name:"500GB", price:0}]},
    { name:"GTA V PC USB Setup (offline)", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]},
    { name:"Micro SD Card (for GameBox)", category:"Accessories", type:"Accessories", variants:[{name:"64GB", price:0}]},
    { name:"PS2 HDMI Converter", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:1999}]},
    { name:"PS2 Wireless Gamepad", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]},
    { name:"PS3 USB HDD 500GB (preloaded)", category:"Accessories", type:"Accessories", variants:[{name:"500GB", price:0}]},
    { name:"PS4 Controller ‚Äî Steel Black", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]},
    { name:"PS4 Gamepad Original (Openbox)", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]},
    { name:"PS4 Pro ‚Äî GTA5 Disc (console)", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]},
    { name:"Pandora SD Card", category:"Accessories", type:"Accessories", variants:[{name:"64GB", price:0}]},
    { name:"Xbox 360 500GB (60 Games)", category:"Accessories", type:"Accessories", variants:[{name:"Unit", price:0}]}
  ];

  /* ------------------ imageMap (same robust loader) ------------------ */
  const imageMap = {
    "PS2-essentials": ["Fmcb.png","Usb.jpg","Usbhdd.jpeg","Ps2hdmi.jpeg","Ps2wire.jpeg","Ps2wireless.jpeg"],
    "GPZ M55": "M55.jpeg",
    "GPZ M22 (Vayava)": ["M22.jpeg","M22.jpg"],
    "GPZ M33 (Vayava)": "M33.jpeg",
    "GPZ M88": "M88.jpeg",
    "GameBox G11 Pro (Regular)": "G11pro.jpeg",
    "GameBox Plus G10 (Vayava)": ["G10.jpeg","G10b.jpeg"],
    "GD35 (Vayava)": "Gd35.jpeg",
    "Gamestick Lite (Pandora Mini M8)": "M8.jpeg",
    "GPZ GD30 (v1) (Vayava)": "Gd30.jpeg",
    "GPZ GD30 v3 (Vayava)": "Gd30v3.jpeg",
    "Gamestick GS5 Mini": ["Gs5mini.jpeg","GS5MINI2.jpeg"],
    "R35s (Budget) ‚Äî Handheld": "R35sb.jpeg",
    "R35s ‚Äî Handheld": "R35s.jpeg",
    "R36 Ultra ‚Äî Handheld": ["R36U.jpeg","R36s.png","R36sb.jpeg"]
  };

  /* ------------------ linksMap (buy+video) based on your inputs ------------------ */
  const linksMap = {
    "Gamestick GD10 (Vayava)": { buy: ["https://gamesplanet.shop/products/vayava-gamestick-gd10","https://amzn.to/45sO3uE","https://amzn.to/45q1P0Z","https://dl.flipkart.com/s/Xb3FJTNNNN"], video: ["https://youtu.be/NTgx-SeWFHY?si=S-923d1Ppa_6io-F","https://youtu.be/t9YSmvB1TTk?si=u6qSLj1BVZ-6aKsF"] },

    "Gamestick GS5 Mini": { buy: [], video: [] },

    "Gamestick M88": { buy: ["https://wa.me/917983624797?text=Hi%20I%20want%20to%20buy%20M88%20GameStick%20at%20Limited%20Offer%20Price%20‚Çπ6699","https://gamesplanet.shop/products/m88","https://gamesplanet.shop/products/m88?sku_id=60200148"], video: ["https://youtu.be/gLm7LZjTMOE","https://youtube.com/shorts/NeWEyEWVw0g?si=DegbcZfRo75H_BaW","https://youtube.com/shorts/5b6xqpiZyo4?si=0_gVyW7bbKXavCAQ"] },

    "GD35 (Vayava)": { buy: ["https://gamesplanet.shop/products/gd35","https://gamesplanet.shop/products/gd35?sku_id=58749947"], video: ["https://youtu.be/v1k6gJtREfk?si=3RHYWRwmI34bxxlv","https://youtu.be/-6jDWfplmkY?si=o90IJTPaEZaCyZhd"] },

    "GD35 GTA San Andreas HD Edition (Vayava)": { buy: [], video: [] },

    "GPZ GAMESTICK LITE (Pandora Mini M8)": { buy: ["https://gamesplanet.shop/products/pandoramini2024","https://dl.flipkart.com/s/1Vhpk8NNNN","https://dl.flipkart.com/s/1VANT_NNNN","https://amzn.to/4eVY8Tp","https://amzn.to/48pOWnv","https://gamesplanet.shop/products/aokogamestick?sku_id=53087300"], video: ["https://youtu.be/eteF9FUaHDs"] },

    "GPZ GAMESTICK PRO (Pandora Pro M15 / P5)": { buy: ["https://gamesplanet.shop/products/p5game?sku_id=53087290","https://amzn.to/4fmYjqB"], video: ["https://youtu.be/UUH26hD7J70","https://youtu.be/6lAcHkh4EZI?si=eesU3FcQlO6-uP76","https://youtu.be/IdNRnqvhRRs?si=k1oUphEPMKiUXivj"] },

    "GPZ GD30 (v1) (Vayava)": { buy: ["https://gamesplanet.shop/products/gd30","https://gamesplanet.shop/products/gamestick-gd30?sku_id=48117969","https://gamesplanet.shop/products/gd30stick?sku_id=44641083"], video: ["https://youtu.be/dJ-C1ACbwik","https://youtu.be/1JE8JtbtmfA","https://youtu.be/zBrVUnyjpV0","https://youtu.be/j36IvDZ2_aw","https://youtu.be/Y3whg4vhLFs","https://youtu.be/HQTMQoc8EMA","https://youtu.be/YPcRREIz4Og"] },

    "GPZ GD30 v2 (Vayava)": { buy: ["https://gamesplanet.shop/products/gd30v2?sku_id=51994998"], video: [] },

    "GPZ GD30 v3 (Vayava)": { buy: ["https://gamesplanet.shop/products/gd30v3"], video: ["https://youtu.be/Zhdwoi-evDI?si=9E9ElkcbE4YpZ4O7","https://youtu.be/1JE8JtbtmfA"] },

    "GPZ GD30 v3 Special Edition (Vayava)": { buy: ["https://gamesplanet.shop/products/gd30v3sp?sku_id=58946948"], video: ["https://youtu.be/Zhdwoi-evDI?si=9E9ElkcbE4YpZ4O7"] },

    "GPZ M22 (Vayava)": { buy: ["https://gamesplanet.shop/products/gpzm22","https://gamesplanet.shop/products/gpzm22?sku_id=60569530","https://bit.ly/GPZm22OG","https://amzn.to/4hQN6j6"], video: ["https://youtu.be/bEt1GvDk8JY?si=Ki1TEJNqdiJvOLUM","https://youtu.be/TnLw-wLWJ6A?si=8wnMnJFpA_AKbhAs"] },

    "GPZ M33 (Vayava)": { buy: ["https://gamesplanet.shop/products/gpzm33","https://gamesplanet.shop/products/gpzm33?sku_id=57837989","https://amzn.to/4hQN6j6","https://bit.ly/m33newG"], video: ["https://youtu.be/h838JHwNI1k?si=Vo-BL1MWqTo4gF8i","https://youtu.be/0dW4go5qaDQ?si=erLso2WIpbUNj0gp","https://youtu.be/TnLw-wLWJ6A?si=8wnMnJFpA_AKbhAs"] },

    "GPZ M55": { buy: ["https://wa.me/917983624797?text=I%20want%20to%20buy%20GPZ%20M55","https://gamesplanet.shop/products/m55?sku_id=60378424"], video: ["https://youtu.be/uMkSclSP5kA?si=zChWREgvdXYk-Gm0"] },

    "GPZ M66": { buy: ["https://gamesplanet.shop/products/m66?sku_id=60378430"], video: [] },

    "GPZ M88": { buy: ["https://wa.me/917983624797?text=Hi%20I%20want%20to%20buy%20M88%20GameStick%20at%20Limited%20Offer%20Price%20‚Çπ6699","https://gamesplanet.shop/products/m88"], video: ["https://youtu.be/gLm7LZjTMOE"] },

    "GameBox G11 Pro (Regular)": { buy: ["https://gamesplanet.shop/products/g11pro","https://gamesplanet.shop/products/gamebox-g11pro?sku_id=45036396"], video: ["https://youtu.be/kJNJ_Kq3NvA?si=C-_ekj4Qna4LzO-s","https://youtu.be/HoRVcbKb77Q?si=X3oSNCYncTLqos-s","https://youtu.be/ILHGhkGNJ2s?si=h-4AWK2YRsPRcvIc"] },

    "GameBox G11 Pro (Special Edition)": { buy: ["https://gamesplanet.shop/products/g11prosp?sku_id=49341287"], video: ["https://youtu.be/ILHGhkGNJ2s?si=h-4AWK2YRsPRcvIc"] },

    "GameBox G11 Pro (GTA San Andreas Edition)": { buy: ["https://gamesplanet.shop/products/game-box-g11-pro-ultimate-edition-wifi-retro-video-game-console-64gb-37000-games-android-9-0-tv-box?sku_id=58534909"], video: [] },

    "GameBox Plus G10 (Vayava)": { buy: ["https://gamesplanet.shop/products/g10?sku_id=49300002","https://amzn.to/4afvbOO"], video: ["https://youtu.be/EGoVlcrre18?si=e5FMmoFI9eMnSMpt","https://youtu.be/l1uVzH-JWgs?si=pehPyGDR5cNQhOJY"] },

    "R35S ‚Äî Handheld Retro Console": { buy: ["https://gamesplanet.shop/products/gpzr35s","https://gamesplanet.shop/products/gpzr35s?sku_id=58960728"], video: ["https://youtu.be/eOEMkNKLSKU?si=Wd_xASTeJUYgZXd8"] },

    "R35s (Budget) ‚Äî Handheld": { buy: ["https://gamesplanet.shop/products/gpzr35s"], video: ["https://youtu.be/eOEMkNKLSKU?si=Wd_xASTeJUYgZXd8"] },

    "R35s ‚Äî Handheld": { buy: ["https://gamesplanet.shop/products/gpzr35s?sku_id=58960728"], video: [] },

    "R36 Ultra ‚Äî Handheld": { buy: [], video: [] },

    "PlayStation 2 Slim (Renewed)": { buy: ["https://Gamesplanet13.github.io/ps2now"], video: ["https://youtu.be/py-V7CQjcYM","https://youtu.be/xGR0vUM1-Jw","https://youtu.be/Lb3dRycJbEc","https://youtu.be/bF3M4aGXHSU"] },

    "PlayStation 3 ‚Äî Renewed (500GB)": { buy: ["https://wa.me/917983624797"], video: [] },

    "PS3 Superslim 250GB": { buy: ["https://gamesplanet.shop/products/ps3-superslim-250-gb-with-12-games?sku_id=44899502"], video: [] },

    "PS4 Slim 1TB ‚Äî GTA5 Bundle (console bundle)": { buy: ["https://gamesplanet.shop/products/ps4-1-tb-slim-9-60-with-gta-5-and-8-top-games?sku_id=46827184"], video: [] },

    /* Accessories */
    "G11 Pro USB SSD (preloaded)": { buy: ["https://gamesplanet.shop/products/g11-pro-usb-drive-usb-ssd-preloaded-games?sku_id=43142774"], video: [] },
    "GTA V PC USB Setup (offline)": { buy: ["https://gamesplanet.shop/products/gta-5-for-pc-offline-full-setup-in-usb?sku_id=49528668"], video: [] },
    "Micro SD Card (for GameBox)": { buy: ["https://gamesplanet.shop/products/micro-sd-card-for-gamebox?sku_id=51941332"], video: [] },
    "PS2 HDMI Converter": { buy: ["https://gamesplanet.shop/products/ps2-hdmi-converter-with-cable"], video: [] },
    "PS2 Wireless Gamepad": { buy: ["https://gamesplanet.shop/products/ps2-wireless-gamepad-1?sku_id=51117958"], video: [] },
    "PS3 USB HDD 500GB (preloaded)": { buy: ["https://gamesplanet.shop/products/ps3-usb-hdd-500-gb-with-games-30-digital-games?sku_id=43769255"], video: [] },
    "PS4 Controller ‚Äî Steel Black": { buy: ["https://gamesplanet.shop/products/ps4-controller-steel-black?sku_id=52326964"], video: [] },
    "PS4 Gamepad Original (Openbox)": { buy: ["https://gamesplanet.shop/products/ps4-gamepad-original-openbox?sku_id=45262217"], video: [] },
    "PS4 Pro ‚Äî GTA5 Disc (console)": { buy: ["https://gamesplanet.shop/products/ps4-pro-with-gta-5-disc?sku_id=42303806"], video: [] },
    "Pandora SD Card": { buy: ["https://gamesplanet.shop/products/pandorasdcard?sku_id=51941246"], video: [] },
    "Xbox 360 500GB (60 Games)": { buy: ["https://gamesplanet.shop/products/xbox-360-500gb-with-60-games-digital-offline-refurbished?sku_id=42303803"], video: [] }
  };

  /* helper: build candidate paths for a filename/array */
  function candidatesFor(nameOrArray){
    const out = [];
    if(!nameOrArray) return out;
    const names = Array.isArray(nameOrArray) ? nameOrArray.slice() : [nameOrArray];
    names.forEach(name=>{
      if(!name) return;
      out.push(name);
      out.push(name.toLowerCase());
      if(!name.startsWith('./')) out.push('./'+name);
      if(!name.startsWith('assets/')) out.push('assets/'+name);
      const m = name.match(/(.+)\.(jpg|jpeg|png|webp)$/i);
      if(m){
        const base = m[1];
        ['png','jpg','jpeg','webp'].forEach(ext=>{
          const s = base + '.' + ext;
          if(!out.includes(s)) out.push(s);
        });
      }
    });
    return [...new Set(out)];
  }

  function tryLoadImageElement(imgEl, candidates, idx=0){
    if(!candidates || candidates.length===0){ imgEl.style.display='none'; console.warn('No candidates for image element', imgEl); return; }
    if(idx >= candidates.length){ imgEl.style.display='none'; console.warn('Image load failed for all candidates:', candidates);
      const hint = document.createElement('div'); hint.className='small'; hint.textContent = 'Image missing: ' + (Array.isArray(candidates)?candidates[0]:candidates);
      imgEl.parentElement && imgEl.parentElement.appendChild(hint);
      return; }
    const src = candidates[idx];
    function onErr(){
      imgEl.removeEventListener('error', onErr);
      imgEl.removeEventListener('load', onLoad);
      tryLoadImageElement(imgEl, candidates, idx+1);
    }
    function onLoad(){
      imgEl.removeEventListener('error', onErr);
      imgEl.removeEventListener('load', onLoad);
      imgEl.dataset.resolved = src;
      imgEl.style.display = '';
    }
    imgEl.addEventListener('error', onErr);
    imgEl.addEventListener('load', onLoad);
    imgEl.src = src;
    setTimeout(()=> {
      if(!imgEl.dataset.resolved && imgEl.complete && imgEl.naturalWidth===0){
        tryLoadImageElement(imgEl, candidates, idx+1);
      }
    }, 900);
  }

  /* link label helper */
  function labelForLink(url){
    try{
      const u = new URL(url);
      const host = u.hostname.replace('www.','').toLowerCase();
      if(host.includes('amazon')) return 'Amazon';
      if(host.includes('flipkart')) return 'Flipkart';
      if(host.includes('wa.me') || host.includes('whatsapp')) return 'WhatsApp';
      if(host.includes('youtube') || host.includes('youtu.be')) return 'YouTube';
      if(host.includes('gamesplanet.shop') || host.includes('gamesplanet')) return 'Website';
      if(host.includes('bit.ly') || host.includes('amzn.to') || host.includes('dl.flipkart')) return 'Link';
      return host;
    }catch(e){
      return 'Link';
    }
  }

  function appendUniqueButtons(container, urls, seenSet, btnClass){
    urls.forEach(u=>{
      if(!u) return;
      if(seenSet.has(u)) return;
      seenSet.add(u);
      const a = document.createElement('a');
      a.href = u;
      a.target = '_blank';
      a.rel = 'noopener';
      a.className = 'btn ' + (btnClass||'link');
      const lbl = labelForLink(u);
      if(lbl==='YouTube') a.textContent = '‚ñ∂Ô∏è Watch';
      else if(lbl==='WhatsApp') a.textContent = 'Buy on WhatsApp ‚Ä¢ With Discount';
      else a.textContent = lbl + ' ‚Ä¢ Open';
      container.appendChild(a);
    });
  }

  /* helpers for filters */
  function getChecked(name){
    return Array.from(document.querySelectorAll('input[name="'+name+'"]:checked')).map(i=>i.value);
  }
  function withinBand(price, band){
    const [lo,hi]=band.split('-').map(Number);
    return price>=lo && price<=hi;
  }

  /* find whatsapp in list */
  function findWhatsAppUrl(urls){
    if(!urls || !urls.length) return null;
    for(const u of urls){
      try{ const host = new URL(u).hostname.toLowerCase(); if(host.includes('wa.me')||host.includes('whatsapp')) return u; }catch(e){}
    }
    return null;
  }
  function waFallback(productName){
    const text = encodeURIComponent('Hi I want to buy ' + productName + ' at best price. Please share details.');
    return 'https://wa.me/917983624797?text=' + text;
  }

  /* ------------------ PATCHED renderCatalog (WhatsApp removed; site-labeled buy buttons) ------------------ */
  function renderCatalog(){
    const grid = document.getElementById('productGrid'); if(!grid) return;
    grid.innerHTML='';

    const priceBands = getChecked('price');
    const cats = getChecked('category');
    const types = getChecked('type');

    function productPasses(p){
      const passCat = cats.length? cats.includes(p.category): true;
      const passTyp = types.length? types.includes(p.type): true;
      if(!passCat || !passTyp) return false;
      if(priceBands.length===0) return true;
      return p.variants.some(v => priceBands.some(b => withinBand(v.price,b)));
    }

    catalog.forEach(p=>{
      if(!productPasses(p)) return;
      const chosenVariants = (priceBands.length===0) ? p.variants : p.variants.filter(v => priceBands.some(b => withinBand(v.price,b)));
      if(chosenVariants.length===0) return;

      const card = document.createElement('section'); card.className='card';

      // image
      const key = p.name;
      const mapped = imageMap[key] || imageMap[key.replace(/\s*\(.*\)$/,'')] || imageMap[key.split(' ')[0]] || null;
      if(mapped){
        const imgDiv = document.createElement('div'); imgDiv.className='imgrow';
        const img = document.createElement('img');
        img.alt = p.name;
        img.style.display = 'none';
        img.width = 160;
        imgDiv.appendChild(img);
        card.appendChild(imgDiv);
        tryLoadImageElement(img, candidatesFor(mapped));
      }

      // header / variants
      const head = document.createElement('div'); head.className='row';
      const nm = document.createElement('div'); nm.className='name'; nm.textContent = p.name;
      const variants = document.createElement('div'); variants.className='variantline';
      chosenVariants.forEach(v=>{
        const b = document.createElement('button'); b.className='btn buy'; b.textContent = `Buy Now ‚Ä¢ ${fmt(v.price)}`;
        b.addEventListener('click', ()=> goPrefill(p.name, v.name, v.price, 'Top'));
        variants.appendChild(b);
      });
      head.appendChild(nm); head.appendChild(variants);
      card.appendChild(head);

      const seen = new Set();
      const linksContainer = document.createElement('div'); linksContainer.className='variantline';
      const videosContainer = document.createElement('div'); videosContainer.className='variantline';

      // collect links from linksMap (if present)
      const collected = (linksMap[p.name]) ? { buy: (linksMap[p.name].buy||[]).slice(), video: (linksMap[p.name].video||[]).slice() } : {buy:[],video:[]};

      // FILTER OUT WhatsApp links entirely (user requested to remove WA buy button)
      const nonWaBuys = (collected.buy || []).filter(u => {
        try{
          const host = new URL(u).hostname.toLowerCase();
          return !(host.includes('wa.me') || host.includes('whatsapp'));
        }catch(e){
          // if invalid URL string, keep it (will be shown as generic Link)
          return true;
        }
      });

      // Append all non-WhatsApp buy links labelled by site name (Amazon / Flipkart / Website / Link etc.)
      appendUniqueButtons(linksContainer, nonWaBuys, seen, 'link');

      // Video links (YouTube) appended as Watch buttons
      if(collected.video && collected.video.length){
        appendUniqueButtons(videosContainer, collected.video, seen, 'video');
      }

      // Attach containers if they have children
      if(linksContainer.children.length){
        card.appendChild(linksContainer);
      }
      if(videosContainer.children.length){
        card.appendChild(videosContainer);
      }

      grid.appendChild(card);
    });

    if(!grid.children.length){
      const empty = document.createElement('div'); empty.className='card';
      empty.innerHTML = '<div class="muted">No products match the selected filters.</div>';
      grid.appendChild(empty);
    }
  }

  /* apply lines */
  function buildApplyLines(){
    document.getElementById('apply-fmcb').textContent = "Applies to: PS2 Essentials ‚Äî FMCB, Games USB, FMCB + USB Combo";
    document.getElementById('apply-media').textContent = "Applies to: USB for PlayStation 2 ‚Äî Game-Loaded, FMCB + USB Combo for PS2";
    const consoleNames = catalog.filter(p=> p.category==='Gamestick' || p.category==='Gamebox' || p.type==='Handheld').map(p=>p.name).join(', ');
    document.getElementById('apply-consoles').textContent = "Applies to: " + consoleNames;
    const accNames = catalog.filter(p=> p.category==='Accessories').map(p=>p.name).join(', ');
    document.getElementById('apply-accessories').textContent = "Applies to: " + accNames;
  }

  document.getElementById('applyFilters')?.addEventListener('click', renderCatalog);
  document.getElementById('resetFilters')?.addEventListener('click', ()=>{
    document.querySelectorAll('input[type="checkbox"]').forEach(c=> c.checked=false);
    renderCatalog();
  });

  /* initial render */
  renderCatalog();
  buildApplyLines();

  console.info('Updated catalog loaded. If any images missing or links fail, open DevTools ‚Üí Console.');
});
</script>
</body>
</html>
'''

path = '/mnt/data/index_patched.html'
with open(path, 'w', encoding='utf-8') as f:
    f.write(html_content)

path

